<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="TDLM">
<title>Tutorial for TDLM • TDLM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial for TDLM">
<meta property="og:description" content="TDLM">
<meta property="og:image" content="https://epivec.github.io/TDLM/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TDLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/TDLM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://github.com/EpiVec/TDLM/releases/tag/v0.1.0">Version 0.1.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EpiVec/TDLM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tutorial for TDLM</h1>
                        <h4 data-toc-skip class="author">Maxime
Lenormand</h4>
            
            <h4 data-toc-skip class="date">2023-08-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EpiVec/TDLM/blob/HEAD/vignettes/TDLM.Rmd" class="external-link"><code>vignettes/TDLM.Rmd</code></a></small>
      <div class="d-none name"><code>TDLM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial aims at describing the different features of the R
package <code>TDLM</code>. The main purpose of the <code>TDLM</code>’s
package is to propose a rigorous framework to fairly compare trip
distribution laws and models <span class="citation">(Lenormand,
Bassolas, and Ramasco 2016)</span>. This general framework is based on a
two-step approach to generate mobility flows by separating the trip
distribution law, gravity or intervening opportunities, from the
modeling approach used to generate the flows from this law.</p>
</div>
<div class="section level2">
<h2 id="a-short-note-on-terminology">A short note on terminology<a class="anchor" aria-label="anchor" href="#a-short-note-on-terminology"></a>
</h2>
<p>This framework is part of the four-step travel model. It corresponds
to the second step, called trip distribution, the aim of which is to
match the trip origins with the trip destinations. The model used to
generate the trips or flows, and more generally the degree of
interaction between different locations, are often called spatial
interaction models. According to the research area, a matrix or a
network formalism can be used to describe these spatial interactions.
Origin-Destination matrix (or trip table) are often used in geography or
transportation while in statistical physics or in the study of complex
systems the term mobility networks is usually preferred.</p>
</div>
<div class="section level2">
<h2 id="origindestination-matrix">Origin–Destination matrix<a class="anchor" aria-label="anchor" href="#origindestination-matrix"></a>
</h2>
<p>The description of movements in a certain area is represented by an
Origin-Destination matrix (OD matrix). The area of interest is divided
into <span class="math inline">\(n\)</span> locations and <span class="math inline">\(T_{ij}\)</span> represents the volume of flows
between location <span class="math inline">\(i\)</span> and location
<span class="math inline">\(j\)</span>. This volume usually represents a
number of trips or a commuting flow (i.e. number of individuals living
in <span class="math inline">\(i\)</span> and working in <span class="math inline">\(j\)</span>). The OD matrix is squared, contains
only positive values and can be a zero-diagonal matrix (Figure 1).</p>
<br><center>
<img align="bottom" width="60%" height="60%" src="../reference/figures/OD.png">
</center>
<br><center>
<b>Figure 1: Schematic representation of an Origin-Destination
matrix.</b>
</center>
<p><br></p>
</div>
<div class="section level2">
<h2 id="aggregated-inputs-information">Aggregated inputs information<a class="anchor" aria-label="anchor" href="#aggregated-inputs-information"></a>
</h2>
<p>Three categories of inputs are usually considered to simulate an OD
matrix (Figure 2). The masses and distances are the main ingredients
used to generate a matrix of probabilities based on a given distribution
law. Hence, the probability <span class="math inline">\(p_{ij}\)</span>
to observe a trip from location <span class="math inline">\(i\)</span>
to another location <span class="math inline">\(j\)</span> is based on
the masses, the demand at origin (<span class="math inline">\(m_i\)</span>) and the offer at destination (<span class="math inline">\(m_j\)</span>). Typically, the population is used
as surrogate for the demand and offer. The probability of movements also
depends on the costs based on the distance <span class="math inline">\(d_{ij}\)</span> between locations or the number of
opportunities <span class="math inline">\(s_{ij}\)</span> between
locations depending on the chosen law (more details in the next “Trip
distribution laws” section). In general both the effect of the cost can
be adjusted with a parameter.</p>
<p>The margins are used to generate an OD matrix based on the matrix of
probabilities by preserving the total number of trips (<span class="math inline">\(N\)</span>), the number of out-going trips (<span class="math inline">\(O_i\)</span>) and/or the number of in-coming trips
(<span class="math inline">\(D_j\)</span>) (more details in the
“Contrained distribution models” section).</p>
<br><center>
<img align="bottom" width="75%" height="75%" src="../reference/figures/Inputs.png">
</center>
<br><center>
<b>Figure 2: Schematic representation of the aggregated inputs
information. </b>
</center>
<p><br></p>
</div>
<div class="section level2">
<h2 id="trip-distribution-laws">Trip distribution laws<a class="anchor" aria-label="anchor" href="#trip-distribution-laws"></a>
</h2>
<p>The purpose of a trip distribution law is to estimate the probability
<span class="math inline">\(p_{ij}\)</span> that out of all the possible
travels in the system we have one between the location <span class="math inline">\(i\)</span> and the location <span class="math inline">\(j\)</span>. This probability is asymmetric in
<span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> as the flows themselves. It takes the
form of squared matrix of probabilities. This probability is normalized
to all possible couples of origins and destinations, <span class="math inline">\(\sum_{i,j=1}^n p_{ij} =1\)</span>. Hence, a matrix
of probabilities can be obtained by normalizing any OD matrix (Figure
3).</p>
<br><center>
<img align="bottom" width="60%" height="60%" src="../reference/figures/Proba.png">
</center>
<br><center>
<b>Figure 3: Schematic representation of the matrix of probabilities.
</b>
</center>
<p><br></p>
<p>As mentioned in the previous section, most of the trip distribution
law depends on the demand at origin (<span class="math inline">\(m_i\)</span>), the offer at destination (<span class="math inline">\(m_j\)</span>) and a cost to move from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>. There are two major approaches for the
estimation of the matrix of probability. The traditional gravity
approach, in analogy with the Newton’s law of gravitation, is based on
the assumption that the amount of trips between two locations is related
to their populations and decays with a function of the distance <span class="math inline">\(d_{ij}\)</span> between locations. In contrast to
the gravity law, the laws of intervening opportunities hinges on the
assumption that the number of opportunities <span class="math inline">\(s_{ij}\)</span> between locations plays a more
important role than the distance <span class="citation">(Lenormand,
Bassolas, and Ramasco 2016)</span>. This fundamental difference between
the two schools of thought is illustrated in Figure 4.</p>
<br><center>
<img align="bottom" width="50%" height="50%" src="../reference/figures/GravVsOpp.png">
</center>
<br><center>
<b>Figure 4: Illustration of the fundamental difference between gravity
and intervening opportunity laws. </b>
</center>
<p><br></p>
<p>It is important to note that the effect of the cost between locations
(distance or number of opportunities) can usually be adjusted with a
parameter that can be calibrated automatically or by comparing the
simulated matrix with observed data (more details in the example based
on real commuting data in Kansas below).</p>
</div>
<div class="section level2">
<h2 id="constrained-distribution-models">Constrained distribution models<a class="anchor" aria-label="anchor" href="#constrained-distribution-models"></a>
</h2>
<p>The purpose of the trip distribution models is to generate an OD
matrix <span class="math inline">\(\tilde{T}=(\tilde{T}_{ij})\)</span>
by drawing at random <span class="math inline">\(N\)</span> trips from
the trip distribution law <span class="math inline">\((p_{ij})_{1 \leq
i,j \leq n}\)</span> respecting different level of constraints according
to the model. We considered four different types of models in this
package. As can be observed in Figure 5, the four models respect
different level of constraints from the total number of trips to the
total number of out-going and in-coming trips by locations (i.e. the
margins).</p>
<br><center>
<img align="bottom" width="80%" height="80%" src="../reference/figures/Models.png">
</center>
<br><center>
<b>Figure 5: Schematic representation of the constrained distribution
models. </b>
</center>
<p><br></p>
<p>More specifically, the volume of flows <span class="math inline">\(\tilde{T}_{ij}\)</span> is generated from the
matrix of probability with multinomial random draws that will take
different forms according to the model used <span class="citation">(Lenormand, Bassolas, and Ramasco 2016)</span>.
Therefore, since the process is stochastic, each simulated matrix is
unique and composed of integers. Note that it is also possible to
generate an average matrix from the multinomial trials.</p>
</div>
<div class="section level2">
<h2 id="goodness-of-fit-measures">Goodness-of-fit measures<a class="anchor" aria-label="anchor" href="#goodness-of-fit-measures"></a>
</h2>
<p>Finally, the trip distribution laws can be calibrated and both the
trip distribution laws and models can be evaluated by comparing a
simulated matrix <span class="math inline">\(\tilde{T}\)</span> with the
observed one <span class="math inline">\(T\)</span>. These comparison
are based on different goodness-of-fit measures that can take into
accounts the distance between location or not (more details in the
example based on real commuting data in Kansas below).</p>
<hr>
</div>
<div class="section level2">
<h2 id="example-of-commuting-in-kansas">Example of commuting in Kansas<a class="anchor" aria-label="anchor" href="#example-of-commuting-in-kansas"></a>
</h2>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>In this example, we will use commuting data from US Kansas in 2000 to
illustrate the main package’s functions. The dataset is composed of
three tables and a spatial object providing information of commuting
flows between the 105 US Kansas counties in 200. The observed OD matrix
<a href="https://epivec.github.io/TDLM/reference/od.html">od</a> is a
zero-diagonal squared matrix of integers. Each element of the matrix
represents the number of commuters between a pair of US Kansas
counties.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">od</span><span class="op">)</span></span>
<span></span>
<span><span class="va">od</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       20001 20003 20005 20007 20009 20011 20013 20015 20017 20019</span></span>
<span><span class="co">## 20001     0    71     0     0     0    73     0     8     0     0</span></span>
<span><span class="co">## 20003   236     0     0     0     0    19     0     0     0     0</span></span>
<span><span class="co">## 20005     0     0     0     0     0     0   195     0     0     0</span></span>
<span><span class="co">## 20007     0     0     0     0     8     0     0     0     0     0</span></span>
<span><span class="co">## 20009     0     0     0    11     0     0     0     1     0     0</span></span>
<span><span class="co">## 20011   116    11     0     0     0     0     0     7     0     0</span></span>
<span><span class="co">## 20013    14     0   162     0     0     0     0     0     0     0</span></span>
<span><span class="co">## 20015     0     0     0     0     0     0     0     0     2     3</span></span>
<span><span class="co">## 20017     0     0     0     0     5     0     0    28     0     0</span></span>
<span><span class="co">## 20019     0     0     0     0     0     0     0    15     0     0</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">od</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 105 105</span></span></code></pre>
<p>The aggregated data are composed of the <a href="https://epivec.github.io/TDLM/reference/distance.html">distance</a>
matrix,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">distance</span><span class="op">)</span></span>
<span></span>
<span><span class="va">distance</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           20001     20003     20005    20007    20009     20011     20013</span></span>
<span><span class="co">## 20001   0.00000  36.50943 182.92913 306.8503 308.8995  39.80310 216.86309</span></span>
<span><span class="co">## 20003  36.50943   0.00000 146.43350 317.5593 303.2348  55.70229 180.68407</span></span>
<span><span class="co">## 20005 182.92913 146.43350   0.00000 389.5330 319.5319 190.61409  39.16442</span></span>
<span><span class="co">## 20007 306.85034 317.55926 389.53300   0.0000 139.0661 345.02113 396.08680</span></span>
<span><span class="co">## 20009 308.89947 303.23478 319.53188 139.0661   0.0000 348.30350 313.18189</span></span>
<span><span class="co">## 20011  39.80310  55.70229 190.61409 345.0211 348.3035   0.00000 227.63541</span></span>
<span><span class="co">## 20013 216.86309 180.68407  39.16442 396.0868 313.1819 227.63541   0.00000</span></span>
<span><span class="co">## 20015 135.45964 143.66094 235.33947 173.8984 184.6661 174.86577 252.67660</span></span>
<span><span class="co">## 20017 122.13915 113.90701 175.91511 218.9859 189.3766 160.48402 191.29570</span></span>
<span><span class="co">## 20019 116.64897 144.89730 276.87712 216.1297 265.3289 145.90037 303.26803</span></span>
<span><span class="co">##           20015     20017     20019</span></span>
<span><span class="co">## 20001 135.45964 122.13915 116.64897</span></span>
<span><span class="co">## 20003 143.66094 113.90701 144.89730</span></span>
<span><span class="co">## 20005 235.33947 175.91511 276.87712</span></span>
<span><span class="co">## 20007 173.89836 218.98595 216.12968</span></span>
<span><span class="co">## 20009 184.66612 189.37664 265.32892</span></span>
<span><span class="co">## 20011 174.86577 160.48402 145.90037</span></span>
<span><span class="co">## 20013 252.67660 191.29570 303.26803</span></span>
<span><span class="co">## 20015   0.00000  61.72259  87.53437</span></span>
<span><span class="co">## 20017  61.72259   0.00000 131.62896</span></span>
<span><span class="co">## 20019  87.53437 131.62896   0.00000</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">distance</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 105 105</span></span></code></pre>
<p>and the masses and margins contained in the data.frame <a href="https://epivec.github.io/TDLM/reference/mass.html">mass</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mass</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       Population Out-commuters In-commuters</span></span>
<span><span class="co">## 20001      14385          1267         1343</span></span>
<span><span class="co">## 20003       8110          1346          361</span></span>
<span><span class="co">## 20005      16774          1065         1247</span></span>
<span><span class="co">## 20007       5307           260          201</span></span>
<span><span class="co">## 20009      28205          1129         1324</span></span>
<span><span class="co">## 20011      15379           662          761</span></span>
<span><span class="co">## 20013      10724          1148          984</span></span>
<span><span class="co">## 20015      59482         14182         3579</span></span>
<span><span class="co">## 20017       3030           681           93</span></span>
<span><span class="co">## 20019       4359           486          180</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 105   3</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mass</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mj</span> <span class="op">&lt;-</span> <span class="va">mi</span></span>
<span></span>
<span><span class="va">Oi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mass</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Oi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mass</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Dj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span></code></pre></div>
<p>Finally, <a href="https://epivec.github.io/TDLM/reference/county.html">county</a> is
a spatial object containing the geometry of the 105 US Kansas counties
in 2000.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">county</span><span class="op">)</span></span>
<span></span>
<span><span class="va">county</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 10 features and 4 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -99.0334 ymin: 36.99796 xmax: -94.6139 ymax: 40.0006</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##         ID Longitude Latitude     Area                       geometry</span></span>
<span><span class="co">## 1016 20001 -95.30137 37.88581 1307.667 MULTIPOLYGON (((-95.08805 3...</span></span>
<span><span class="co">## 983  20003 -95.29334 38.21429 1512.337 MULTIPOLYGON (((-95.07771 3...</span></span>
<span><span class="co">## 869  20005 -95.31288 39.53194 1125.682 MULTIPOLYGON (((-95.56751 3...</span></span>
<span><span class="co">## 1064 20007 -98.68482 37.22888 2941.524 MULTIPOLYGON (((-98.52686 3...</span></span>
<span><span class="co">## 962  20009 -98.75650 38.47904 2330.541 MULTIPOLYGON (((-99.03239 3...</span></span>
<span><span class="co">## 1017 20011 -94.84928 37.85522 1653.609 MULTIPOLYGON (((-94.61413 3...</span></span>
<span><span class="co">## 843  20013 -95.56416 39.82657 1480.469 MULTIPOLYGON (((-95.77332 3...</span></span>
<span><span class="co">## 1011 20015 -96.83911 37.78125 3744.168 MULTIPOLYGON (((-96.52571 3...</span></span>
<span><span class="co">## 974  20017 -96.59395 38.30205 2013.697 MULTIPOLYGON (((-96.81972 3...</span></span>
<span><span class="co">## 1079 20019 -96.24535 37.15007 1669.418 MULTIPOLYGON (((-96.52495 3...</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">county</span><span class="op">)</span></span></code></pre></div>
<p><img src="TDLM_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>The data must always be based on the same number of locations sorted
in the same order. The function <a href="https://epivec.github.io/TDLM/reference/check_format_names.html">check_format_names</a>
can be used to control the validity of all the inputs before running the
main package’s functions.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_format_names.html">check_format_names</a></span><span class="op">(</span>vectors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mi <span class="op">=</span> <span class="va">mi</span>, mj <span class="op">=</span> <span class="va">mj</span>, Oi <span class="op">=</span> <span class="va">Oi</span>, Dj <span class="op">=</span> <span class="va">Dj</span><span class="op">)</span>,</span>
<span>                   matrices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>od <span class="op">=</span> <span class="va">od</span>, distance <span class="op">=</span> <span class="va">distance</span><span class="op">)</span>,</span>
<span>                   check <span class="op">=</span> <span class="st">"format_and_names"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The inputs passed the format_and_names checks successfully!</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="extract-additional-spatial-information">Extract additional spatial information<a class="anchor" aria-label="anchor" href="#extract-additional-spatial-information"></a>
</h3>
<p>The functions <a href="https://epivec.github.io/TDLM/reference/extract_spatial_information.html">extract_spatial_information</a>
and <a href="https://epivec.github.io/TDLM/reference/check_format_names.html">extract_opportunities</a>
can be used to extract the matrices of distances and number of
intervening opportunities, respectively.</p>
<p>The first function takes as input a spatial object containing the
geometry of the locations that can be handled by the <a href="https://cran.r-project.org/package=sf" class="external-link">sf</a> package. It returns
a matrix of great-circle distances between locations (express in km). An
optional <code>id</code> can also be provided to be used as names for
the outputs.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_spatial_information.html">extract_spatial_information</a></span><span class="op">(</span><span class="va">county</span>, id <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">distance2</span> <span class="op">&lt;-</span> <span class="va">spi</span><span class="op">$</span><span class="va">distance</span></span>
<span></span>
<span><span class="va">distance2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##           20001     20003     20005    20007    20009     20011     20013</span></span>
<span><span class="co">## 20001   0.00000  36.50943 182.92913 306.8503 308.8995  39.80310 216.86309</span></span>
<span><span class="co">## 20003  36.50943   0.00000 146.43350 317.5593 303.2348  55.70229 180.68407</span></span>
<span><span class="co">## 20005 182.92913 146.43350   0.00000 389.5330 319.5319 190.61409  39.16442</span></span>
<span><span class="co">## 20007 306.85034 317.55926 389.53300   0.0000 139.0661 345.02113 396.08680</span></span>
<span><span class="co">## 20009 308.89947 303.23478 319.53188 139.0661   0.0000 348.30350 313.18189</span></span>
<span><span class="co">## 20011  39.80310  55.70229 190.61409 345.0211 348.3035   0.00000 227.63541</span></span>
<span><span class="co">## 20013 216.86309 180.68407  39.16442 396.0868 313.1819 227.63541   0.00000</span></span>
<span><span class="co">## 20015 135.45964 143.66094 235.33947 173.8984 184.6661 174.86577 252.67660</span></span>
<span><span class="co">## 20017 122.13915 113.90701 175.91511 218.9859 189.3766 160.48402 191.29570</span></span>
<span><span class="co">## 20019 116.64897 144.89730 276.87712 216.1297 265.3289 145.90037 303.26803</span></span>
<span><span class="co">##           20015     20017     20019</span></span>
<span><span class="co">## 20001 135.45964 122.13915 116.64897</span></span>
<span><span class="co">## 20003 143.66094 113.90701 144.89730</span></span>
<span><span class="co">## 20005 235.33947 175.91511 276.87712</span></span>
<span><span class="co">## 20007 173.89836 218.98595 216.12968</span></span>
<span><span class="co">## 20009 184.66612 189.37664 265.32892</span></span>
<span><span class="co">## 20011 174.86577 160.48402 145.90037</span></span>
<span><span class="co">## 20013 252.67660 191.29570 303.26803</span></span>
<span><span class="co">## 20015   0.00000  61.72259  87.53437</span></span>
<span><span class="co">## 20017  61.72259   0.00000 131.62896</span></span>
<span><span class="co">## 20019  87.53437 131.62896   0.00000</span></span></code></pre>
<p>This function allows also to extract the number of the surface area
of each location (in squared kilometer) that can be useful to calibrate
the trip distribution laws parameter value (see below).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">spi</span><span class="op">$</span><span class="va">surface</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2028.05</span></span></code></pre>
<p>The second function computes the number of opportunities between
pairs of locations. For a given pair of location the number of
opportunities between the location of origin and the location of
destination is based on the number of opportunities in a circle of
radius equal to the distance between origin and destination centered in
the origin. The number of opportunities at origin and destination are
not included. In our case, the number of inhabitants (<span class="math inline">\(m_i\)</span>) is used as proxy for the number of
opportunity.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sij</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_opportunities.html">extract_opportunities</a></span><span class="op">(</span>opportunity <span class="op">=</span> <span class="va">mi</span>,</span>
<span>                             distance <span class="op">=</span> <span class="va">distance</span>,</span>
<span>                             check_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sij</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##         20001   20003   20005   20007   20009   20011   20013   20015   20017</span></span>
<span><span class="co">## 20001       0   16997 1445725 2358187 2363494   28895 2112382 1037999  865098</span></span>
<span><span class="co">## 20003       0       0 1374401 2403828 2354815   89743 1577419 1310560 1219766</span></span>
<span><span class="co">## 20005 1311224 1240896       0 2454129 2346302 1329397   26675 1507244 1308194</span></span>
<span><span class="co">## 20007 1433163 1481954 2489482       0  634786 1761752 2506256  784401 1033184</span></span>
<span><span class="co">## 20009 1778443 1651945 1820549  344665       0 2426105 1792828 1006105 1070707</span></span>
<span><span class="co">## 20011   47812   79194 1390766 2357193 2362500       0 1520832 1288889 1278974</span></span>
<span><span class="co">## 20013 1410286 1302399   18966 2475846 2326406 1436135       0 1501910 1330347</span></span>
<span><span class="co">## 20015  874190  957116 2331868 1272683 1471752 1277990 2390227       0  529702</span></span>
<span><span class="co">## 20017 1108686 1021292 2081327 2408908 2312482 1491593 2340687   63073       0</span></span>
<span><span class="co">## 20019  222857  795722 2320023 1387590 2282995  839767 2400214  116644  759823</span></span>
<span><span class="co">##         20019</span></span>
<span><span class="co">## 20001  409653</span></span>
<span><span class="co">## 20003 1370042</span></span>
<span><span class="co">## 20005 1734928</span></span>
<span><span class="co">## 20007 1025564</span></span>
<span><span class="co">## 20009 1355225</span></span>
<span><span class="co">## 20011 1017627</span></span>
<span><span class="co">## 20013 2285756</span></span>
<span><span class="co">## 20015  575300</span></span>
<span><span class="co">## 20017 1238018</span></span>
<span><span class="co">## 20019       0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="run-functions">Run functions<a class="anchor" aria-label="anchor" href="#run-functions"></a>
</h3>
<p>The main function of the package is <a href="https://epivec.github.io/TDLM/reference/run_law_model.html">run_law_model</a>.
The function has two sets of arguments, one for the law and another one
for the model. The inputs (described above) necessary to run this
function depends on the law (either the matrix of distances or number of
opportunities can be used, or neither of them for the uniform law) and
on the model and its associated constraints (number of trips, out-going
trips and/or in-coming trips). The example below will generate three
simulated ODs with the normalized gravity law with an exponential
distance decay function <span class="citation">(Lenormand, Bassolas, and
Ramasco 2016)</span> and the Doubly Constrained Model.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_law_model.html">run_law_model</a></span><span class="op">(</span>law <span class="op">=</span> <span class="st">"NGravExp"</span>, </span>
<span>                     mass_origin <span class="op">=</span> <span class="va">mi</span>, </span>
<span>                     mass_destination <span class="op">=</span> <span class="va">mj</span>, </span>
<span>                     distance <span class="op">=</span> <span class="va">distance</span>, </span>
<span>                     opportunity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     param <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                     write_proba <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     </span>
<span>                     model <span class="op">=</span> <span class="st">"DCM"</span>, </span>
<span>                     nb_trips <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     out_trips <span class="op">=</span> <span class="va">Oi</span>, </span>
<span>                     in_trips <span class="op">=</span> <span class="va">Dj</span>,</span>
<span>                     average <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                     nbrep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The output is an object of class <code>TDLM</code>. In this case it
is a list of matrices composed of the three simulated matrices
(<code>replication_1</code>, <code>replication_2</code> and
<code>replication_3</code>), the matrix of probabilities (called
<code>proba</code>) associated with the law and returned only if
<code>write_proba = TRUE</code>. The objects of class <code>TDLM</code>
contain a table <code>info</code> summarizing the simulation run.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        Argument    Value</span></span>
<span><span class="co">## 1           Law NGravExp</span></span>
<span><span class="co">## 2         Model      DCM</span></span>
<span><span class="co">## 3 #Replications        3</span></span>
<span><span class="co">## 4   #Parameters        1</span></span>
<span><span class="co">## 5     Parameter     0.01</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 5</span></span>
<span><span class="co">##  $ info         :'data.frame':   5 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ Argument: chr [1:5] "Law" "Model" "#Replications" "#Parameters" ...</span></span>
<span><span class="co">##   ..$ Value   : chr [1:5] "NGravExp" "DCM" "3" "1" ...</span></span>
<span><span class="co">##  $ replication_1: num [1:105, 1:105] 0 23 4 0 2 15 4 103 6 6 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##  $ replication_2: num [1:105, 1:105] 0 25 4 0 2 16 5 105 7 6 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##  $ replication_3: num [1:105, 1:105] 0 23 4 0 2 15 4 103 5 6 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##  $ proba        : num [1:105, 1:105] 0.00 4.31e-05 2.16e-05 3.90e-06 1.81e-05 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##  - attr(*, "class")= chr [1:2] "TDLM" "list"</span></span>
<span><span class="co">##  - attr(*, "from")= chr "run_law_model"</span></span>
<span><span class="co">##  - attr(*, "proba")= logi TRUE</span></span></code></pre>
<p>This simulation run was based on one parameter value. It is possible
to use a vector instead of a scalar for the <code>param</code>
argument.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_law_model.html">run_law_model</a></span><span class="op">(</span>law <span class="op">=</span> <span class="st">"NGravExp"</span>, </span>
<span>                     mass_origin <span class="op">=</span> <span class="va">mi</span>, </span>
<span>                     mass_destination <span class="op">=</span> <span class="va">mj</span>, </span>
<span>                     distance <span class="op">=</span> <span class="va">distance</span>, </span>
<span>                     opportunity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.02</span><span class="op">)</span>,</span>
<span>                     write_proba <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     </span>
<span>                     model <span class="op">=</span> <span class="st">"DCM"</span>, </span>
<span>                     nb_trips <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     out_trips <span class="op">=</span> <span class="va">Oi</span>, </span>
<span>                     in_trips <span class="op">=</span> <span class="va">Dj</span>,</span>
<span>                     average <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                     nbrep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>In this case a list of list of matrices will be returned (one for
each parameter value).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        Argument    Value</span></span>
<span><span class="co">## 1           Law NGravExp</span></span>
<span><span class="co">## 2         Model      DCM</span></span>
<span><span class="co">## 3 #Replications        3</span></span>
<span><span class="co">## 4   #Parameters        2</span></span>
<span><span class="co">## 5   Parameter 1     0.01</span></span>
<span><span class="co">## 6   Parameter 2     0.02</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 3</span></span>
<span><span class="co">##  $ info       :'data.frame': 6 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ Argument: chr [1:6] "Law" "Model" "#Replications" "#Parameters" ...</span></span>
<span><span class="co">##   ..$ Value   : chr [1:6] "NGravExp" "DCM" "3" "2" ...</span></span>
<span><span class="co">##  $ parameter_1:List of 4</span></span>
<span><span class="co">##   ..$ replication_1: num [1:105, 1:105] 0 23 4 0 2 15 4 105 5 6 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   ..$ replication_2: num [1:105, 1:105] 0 23 4 0 2 15 4 103 5 6 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   ..$ replication_3: num [1:105, 1:105] 0 23 4 0 2 17 5 103 5 6 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   ..$ proba        : num [1:105, 1:105] 0.00 4.31e-05 2.16e-05 3.90e-06 1.81e-05 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##  $ parameter_2:List of 4</span></span>
<span><span class="co">##   ..$ replication_1: num [1:105, 1:105] 0 53 2 0 0 38 1 76 5 7 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   ..$ replication_2: num [1:105, 1:105] 0 56 2 0 0 38 1 77 5 7 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   ..$ replication_3: num [1:105, 1:105] 0 53 2 0 0 39 1 77 5 7 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   ..$ proba        : num [1:105, 1:105] 0.00 8.13e-05 8.17e-06 7.10e-07 3.16e-06 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##  - attr(*, "class")= chr [1:2] "TDLM" "list"</span></span>
<span><span class="co">##  - attr(*, "from")= chr "run_law_model"</span></span>
<span><span class="co">##  - attr(*, "proba")= logi TRUE</span></span></code></pre>
<p>It is also important to note that the radiation law and the uniform
law are free of parameter.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_law_model.html">run_law_model</a></span><span class="op">(</span>law <span class="op">=</span> <span class="st">"Rad"</span>, </span>
<span>                     mass_origin <span class="op">=</span> <span class="va">mi</span>, </span>
<span>                     mass_destination <span class="op">=</span> <span class="va">mj</span>, </span>
<span>                     distance <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     opportunity <span class="op">=</span> <span class="va">sij</span>,</span>
<span>                     param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     write_proba <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     </span>
<span>                     model <span class="op">=</span> <span class="st">"DCM"</span>, </span>
<span>                     nb_trips <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     out_trips <span class="op">=</span> <span class="va">Oi</span>, </span>
<span>                     in_trips <span class="op">=</span> <span class="va">Dj</span>,</span>
<span>                     average <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                     nbrep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        Argument Value</span></span>
<span><span class="co">## 1           Law   Rad</span></span>
<span><span class="co">## 2         Model   DCM</span></span>
<span><span class="co">## 3 #Replications     3</span></span></code></pre>
<p>The argument <code>average</code> can be used to generate an average
matrix based on a multinomial distribution (based on an infinite number
of drawings). In this case, the models’ inputs can be either positive
integer or real numbers and the output (<code>nbrep = 1</code> in this
case) will be a matrix of positive real numbers.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">replication_1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span><span class="co">##  [1,]    0   32    0    0    0  120    0    1    0     0</span></span>
<span><span class="co">##  [2,]  570    0    0    0    0   24    0    0    0     0</span></span>
<span><span class="co">##  [3,]    0    0    0    0    0    0  198    0    0     0</span></span>
<span><span class="co">##  [4,]    0    0    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">##  [5,]    0    0    0    1    0    0    0    3    0     0</span></span>
<span><span class="co">##  [6,]   17    2    0    0    0    0    0    0    0     0</span></span>
<span><span class="co">##  [7,]    0    0  202    0    0    0    0    0    0     0</span></span>
<span><span class="co">##  [8,]    4    1    1    1   10    5    1    0    0     1</span></span>
<span><span class="co">##  [9,]    0    0    0    0    0    0    0   40    0     0</span></span>
<span><span class="co">## [10,]    0    0    0    0    0    0    0   13    0     0</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_law_model.html">run_law_model</a></span><span class="op">(</span>law <span class="op">=</span> <span class="st">"Rad"</span>, </span>
<span>                     mass_origin <span class="op">=</span> <span class="va">mi</span>, </span>
<span>                     mass_destination <span class="op">=</span> <span class="va">mj</span>, </span>
<span>                     distance <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     opportunity <span class="op">=</span> <span class="va">sij</span>,</span>
<span>                     param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     write_proba <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     </span>
<span>                     model <span class="op">=</span> <span class="st">"DCM"</span>, </span>
<span>                     nb_trips <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     out_trips <span class="op">=</span> <span class="va">Oi</span>, </span>
<span>                     in_trips <span class="op">=</span> <span class="va">Dj</span>,</span>
<span>                     average <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     nbrep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        Argument       Value</span></span>
<span><span class="co">## 1           Law         Rad</span></span>
<span><span class="co">## 2         Model         DCM</span></span>
<span><span class="co">## 3 #Replications 1 (average)</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">replication_1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##               [,1]         [,2]         [,3]         [,4]         [,5]</span></span>
<span><span class="co">##  [1,] 4.207454e-04 3.248924e+01 1.629984e-01 0.0169209490 1.523725e-01</span></span>
<span><span class="co">##  [2,] 5.645506e+02 6.155812e-04 1.486180e-01 0.0133929974 1.262074e-01</span></span>
<span><span class="co">##  [3,] 8.174148e-02 2.927128e-02 8.564946e-04 0.0180562693 1.785403e-01</span></span>
<span><span class="co">##  [4,] 5.866220e-03 1.762770e-03 5.461852e-03 0.0006206272 1.984250e-01</span></span>
<span><span class="co">##  [5,] 7.824940e-02 2.902253e-02 2.083665e-01 1.3841229993 7.860351e-04</span></span>
<span><span class="co">##  [6,] 1.794519e+01 2.896778e+00 1.227317e-01 0.0118216041 1.064531e-01</span></span>
<span><span class="co">##  [7,] 4.854529e-02 1.825077e-02 2.003666e+02 0.0121155517 1.240133e-01</span></span>
<span><span class="co">##  [8,] 4.235287e+00 1.150834e+00 1.817298e+00 1.5952317911 1.087001e+01</span></span>
<span><span class="co">##  [9,] 1.701860e-02 6.442397e-03 1.358021e-02 0.0027705322 2.718136e-02</span></span>
<span><span class="co">## [10,] 3.657437e-01 9.929259e-03 1.029943e-02 0.0078265447 2.624542e-02</span></span>
<span><span class="co">##               [,6]         [,7]         [,8]         [,9]        [,10]</span></span>
<span><span class="co">##  [1,] 1.206594e+02 8.830093e-02  1.637304888 0.0120698542 0.0777923728</span></span>
<span><span class="co">##  [2,] 2.261365e+01 1.297312e-01  0.862290746 0.0050699294 0.0060667099</span></span>
<span><span class="co">##  [3,] 1.934135e-01 1.973623e+02  0.918724724 0.0061614808 0.0053164987</span></span>
<span><span class="co">##  [4,] 9.469349e-03 6.169547e-03  0.278155220 0.0008433002 0.0012892865</span></span>
<span><span class="co">##  [5,] 1.033249e-01 2.460352e-01  3.462295645 0.0158169340 0.0150487684</span></span>
<span><span class="co">##  [6,] 5.850044e-04 1.180099e-01  0.752499705 0.0038974570 0.0092130934</span></span>
<span><span class="co">##  [7,] 1.138611e-01 2.549294e-03  0.633540548 0.0040869895 0.0021031775</span></span>
<span><span class="co">##  [8,] 5.040588e+00 1.982879e+00  0.002650424 0.7993806174 1.0370497229</span></span>
<span><span class="co">##  [9,] 2.296625e-02 1.230871e-02 39.049317001 0.0005691793 0.0015470504</span></span>
<span><span class="co">## [10,] 6.732294e-02 1.102089e-02 13.987963900 0.0025478503 0.0002716179</span></span></code></pre>
<p>The functions <a href="https://epivec.github.io/TDLM/reference/run_law.html">run_law</a>
and <a href="https://epivec.github.io/TDLM/reference/run_model.html">run_model</a>
have been designed to run only one of the two components of the two-step
approach. They function the same as a <a href="https://epivec.github.io/TDLM/reference/run_law_model.html">run_law_model</a>,
but it is worth noting that only inter-location flows are considered for
the distribution laws, meaning that the matrix of probabilities (and
associated simulated OD matrices) generated by a given distribution law
with <a href="https://epivec.github.io/TDLM/reference/run_law_model.html">run_law_model</a>
or <a href="https://epivec.github.io/TDLM/reference/run_law.html">run_law</a>
is a zero-diagonal matrix. Nevertheless, it is possible to generate
intra-location flows with <a href="https://epivec.github.io/TDLM/reference/run_model.html">run_model</a>
taking any kind of matrix of probabilities as input.</p>
</div>
<div class="section level3">
<h3 id="parameters-calibration-models-evaluation">Parameters’ calibration &amp; models’ evaluation<a class="anchor" aria-label="anchor" href="#parameters-calibration-models-evaluation"></a>
</h3>
<p>The package contains two function to help calibrating and evaluating
the model. The function <a href="https://epivec.github.io/TDLM/reference/gof.html">gof</a> computes
goodness-of-fit measures between observed and simulated OD matrices and
the function <a href="https://epivec.github.io/TDLM/reference/calib_param.html">calib_param</a>
that estimates the optimal parameter value for a given law and a given
spatial distribution of location based on the Figure 8 in <span class="citation">(Lenormand, Bassolas, and Ramasco 2016)</span>.</p>
<p>Let us illustrate the trip distribution laws and models’ calibration
with the the normalized gravity law with an exponential distance decay
function and the Doubly Constrained Model. Based on the average surface
area of the Kansas counties (in square kilometers) it seems that the
optimal parameter value of the normalized gravity law with an
exponential distance decay function (as described in <span class="citation">(Lenormand, Bassolas, and Ramasco 2016)</span>) for
commuting in US Kansas counties is around 0.085.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/calib_param.html">calib_param</a></span><span class="op">(</span>av_surf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">spi</span><span class="op">$</span><span class="va">surface</span><span class="op">)</span>, law <span class="op">=</span> <span class="st">"NGravExp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.08521097</span></span></code></pre>
<p>This is just an estimation that help us to identify the potential
range of parameter value, so in order to rigorously calibrate and
evaluate the trip distribution law and model we need to compute the
goodness-of-fit measure for a wide range of parameter values.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_law_model.html">run_law_model</a></span><span class="op">(</span>law <span class="op">=</span> <span class="st">"NGravExp"</span>, </span>
<span>                     mass_origin <span class="op">=</span> <span class="va">mi</span>, </span>
<span>                     mass_destination <span class="op">=</span> <span class="va">mj</span>, </span>
<span>                     distance <span class="op">=</span> <span class="va">distance</span>, </span>
<span>                     opportunity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                     param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.005</span><span class="op">)</span>,</span>
<span>                     write_proba <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     </span>
<span>                     model <span class="op">=</span> <span class="st">"DCM"</span>, </span>
<span>                     nb_trips <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     out_trips <span class="op">=</span> <span class="va">Oi</span>, </span>
<span>                     in_trips <span class="op">=</span> <span class="va">Dj</span>,</span>
<span>                     average <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                     nbrep <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">calib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gof.html">gof</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">res</span>, obs <span class="op">=</span> <span class="va">od</span>, measures <span class="op">=</span> <span class="st">"all"</span>, distance <span class="op">=</span> <span class="va">distance</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">calib</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       Parameter Parameter_value    Simulation       CPC     NRMSE         KL</span></span>
<span><span class="co">## 1   parameter_1            0.05 replication_1 0.8164535 10.513961 0.12933490</span></span>
<span><span class="co">## 2   parameter_1            0.05 replication_2 0.8163736 10.524516 0.12941875</span></span>
<span><span class="co">## 3   parameter_1            0.05 replication_3 0.8163436 10.520915 0.12952054</span></span>
<span><span class="co">## 4   parameter_2           0.055 replication_1 0.8316920  9.417863 0.11325043</span></span>
<span><span class="co">## 5   parameter_2           0.055 replication_2 0.8314774  9.426661 0.11345362</span></span>
<span><span class="co">## 6   parameter_2           0.055 replication_3 0.8316371  9.420577 0.11327672</span></span>
<span><span class="co">## 7   parameter_3            0.06 replication_1 0.8440506  8.646542 0.09825719</span></span>
<span><span class="co">## 8   parameter_3            0.06 replication_2 0.8439408  8.646137 0.09822824</span></span>
<span><span class="co">## 9   parameter_3            0.06 replication_3 0.8440855  8.642724 0.09822923</span></span>
<span><span class="co">## 10  parameter_4           0.065 replication_1 0.8520617  8.166409 0.08794545</span></span>
<span><span class="co">## 11  parameter_4           0.065 replication_2 0.8519718  8.171713 0.08807803</span></span>
<span><span class="co">## 12  parameter_4           0.065 replication_3 0.8518970  8.175381 0.08782277</span></span>
<span><span class="co">## 13  parameter_5            0.07 replication_1 0.8553709  7.957752 0.07997849</span></span>
<span><span class="co">## 14  parameter_5            0.07 replication_2 0.8553011  7.961606 0.08038099</span></span>
<span><span class="co">## 15  parameter_5            0.07 replication_3 0.8552212  7.958406 0.08017661</span></span>
<span><span class="co">## 16  parameter_6           0.075 replication_1 0.8556155  7.959707 0.07933579</span></span>
<span><span class="co">## 17  parameter_6           0.075 replication_2 0.8557004  7.958248 0.07908605</span></span>
<span><span class="co">## 18  parameter_6           0.075 replication_3 0.8558351  7.945436 0.07917017</span></span>
<span><span class="co">## 19  parameter_7            0.08 replication_1 0.8551912  8.101786 0.07424888</span></span>
<span><span class="co">## 20  parameter_7            0.08 replication_2 0.8549866  8.116146 0.07426440</span></span>
<span><span class="co">## 21  parameter_7            0.08 replication_3 0.8550515  8.113038 0.07420861</span></span>
<span><span class="co">## 22  parameter_8           0.085 replication_1 0.8531897  8.373917 0.07381964</span></span>
<span><span class="co">## 23  parameter_8           0.085 replication_2 0.8530999  8.379994 0.07373777</span></span>
<span><span class="co">## 24  parameter_8           0.085 replication_3 0.8530649  8.374893 0.07366679</span></span>
<span><span class="co">## 25  parameter_9            0.09 replication_1 0.8499304  8.710749 0.07466713</span></span>
<span><span class="co">## 26  parameter_9            0.09 replication_2 0.8499154  8.701567 0.07521379</span></span>
<span><span class="co">## 27  parameter_9            0.09 replication_3 0.8500102  8.698367 0.07507077</span></span>
<span><span class="co">## 28 parameter_10           0.095 replication_1 0.8463516  9.097593 0.08097439</span></span>
<span><span class="co">## 29 parameter_10           0.095 replication_2 0.8463965  9.093998 0.08100610</span></span>
<span><span class="co">## 30 parameter_10           0.095 replication_3 0.8463416  9.093782 0.08106385</span></span>
<span><span class="co">## 31 parameter_11             0.1 replication_1 0.8424384  9.478782 0.08344893</span></span>
<span><span class="co">## 32 parameter_11             0.1 replication_2 0.8423435  9.491386 0.08303843</span></span>
<span><span class="co">## 33 parameter_11             0.1 replication_3 0.8423036  9.485250 0.08347356</span></span>
<span><span class="co">##          CPL     CPC_d    KS_stat   KS_pval</span></span>
<span><span class="co">## 1  0.6594274 0.8952967 0.07315135 0.9998501</span></span>
<span><span class="co">## 2  0.6592593 0.8953316 0.07307648 0.9998532</span></span>
<span><span class="co">## 3  0.6594221 0.8952817 0.07312639 0.9998508</span></span>
<span><span class="co">## 4  0.6709979 0.9155016 0.05004643 1.0000000</span></span>
<span><span class="co">## 5  0.6713432 0.9154567 0.05003146 1.0000000</span></span>
<span><span class="co">## 6  0.6706494 0.9156863 0.04985177 1.0000000</span></span>
<span><span class="co">## 7  0.6731549 0.9318732 0.03026575 1.0000000</span></span>
<span><span class="co">## 8  0.6724324 0.9316735 0.03021584 1.0000000</span></span>
<span><span class="co">## 9  0.6726142 0.9318283 0.03028073 1.0000000</span></span>
<span><span class="co">## 10 0.6726761 0.9431636 0.03381959 1.0000000</span></span>
<span><span class="co">## 11 0.6734234 0.9430688 0.03374971 1.0000000</span></span>
<span><span class="co">## 12 0.6724866 0.9428392 0.03377467 1.0000000</span></span>
<span><span class="co">## 13 0.6740654 0.9495475 0.03742833 1.0000000</span></span>
<span><span class="co">## 14 0.6750365 0.9495925 0.03743831 1.0000000</span></span>
<span><span class="co">## 15 0.6736719 0.9494128 0.03746826 1.0000000</span></span>
<span><span class="co">## 16 0.6724917 0.9481899 0.04352774 1.0000000</span></span>
<span><span class="co">## 17 0.6718891 0.9479553 0.04358265 1.0000000</span></span>
<span><span class="co">## 18 0.6718891 0.9480801 0.04356768 1.0000000</span></span>
<span><span class="co">## 19 0.6629492 0.9408726 0.04950238 1.0000000</span></span>
<span><span class="co">## 20 0.6629492 0.9408327 0.04953233 1.0000000</span></span>
<span><span class="co">## 21 0.6631546 0.9408077 0.04951735 1.0000000</span></span>
<span><span class="co">## 22 0.6518141 0.9330112 0.05648526 1.0000000</span></span>
<span><span class="co">## 23 0.6509704 0.9328815 0.05656013 1.0000000</span></span>
<span><span class="co">## 24 0.6516067 0.9328864 0.05646031 1.0000000</span></span>
<span><span class="co">## 25 0.6413008 0.9257738 0.06233012 0.9999993</span></span>
<span><span class="co">## 26 0.6404421 0.9257388 0.06237005 0.9999993</span></span>
<span><span class="co">## 27 0.6406758 0.9258187 0.06237504 0.9999993</span></span>
<span><span class="co">## 28 0.6350679 0.9186561 0.06728652 0.9999941</span></span>
<span><span class="co">## 29 0.6357616 0.9187310 0.06723162 0.9999942</span></span>
<span><span class="co">## 30 0.6353097 0.9186511 0.06728652 0.9999941</span></span>
<span><span class="co">## 31 0.6235613 0.9121574 0.07270712 0.9999610</span></span>
<span><span class="co">## 32 0.6235613 0.9120077 0.07281693 0.9999597</span></span>
<span><span class="co">## 33 0.6237724 0.9120226 0.07282192 0.9999595</span></span></code></pre>
<p>All the necessary information is stored in the object calib, most of
the goodness-of-fit measures agree on a parameter value of 0.075 in that
case with an associated average Common Part of Commuter equal to
85.6%.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">calib</span><span class="op">$</span><span class="va">CPC</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">calib</span><span class="op">$</span><span class="va">Parameter_value</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">oldmar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">mar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">6</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.005</span><span class="op">)</span>, <span class="va">cpc</span>, type<span class="op">=</span><span class="st">"b"</span>, pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">2</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">3</span>, </span>
<span>     col<span class="op">=</span><span class="st">"steelblue3"</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, cex.axis<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, cex.axis<span class="op">=</span><span class="fl">1.2</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Parameter value"</span>, <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">3.25</span>, cex <span class="op">=</span> <span class="fl">1.75</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Common Part of Commuters"</span>, <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">4</span>, cex <span class="op">=</span> <span class="fl">1.75</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="TDLM_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="va">oldmar</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Lenormand2016" class="csl-entry">
Lenormand, M., A. Bassolas, and J. J. Ramasco. 2016. <span>“Systematic
Comparison of Trip Distribution Laws and Models.”</span> <em>Journal of
Transport Geography</em> 51: 158–69.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Maxime Lenormand.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
