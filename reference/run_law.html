<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate mobility flows based on different trip distribution laws — run_law • TDLM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate mobility flows based on different trip distribution laws — run_law"><meta name="description" content="This function estimates mobility flows using different distribution laws
and models. As described in Lenormand et al. (2016), the
function uses a two-step approach to generate mobility flows by separating
the trip distribution law (gravity or intervening opportunities) from the
modeling approach used to generate the flows based on this law. This function
only uses the first step to generate a probability distribution based on the
different laws."><meta property="og:description" content="This function estimates mobility flows using different distribution laws
and models. As described in Lenormand et al. (2016), the
function uses a two-step approach to generate mobility flows by separating
the trip distribution law (gravity or intervening opportunities) from the
modeling approach used to generate the flows based on this law. This function
only uses the first step to generate a probability distribution based on the
different laws."><meta property="og:image" content="https://epivec.github.io/TDLM/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TDLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/TDLM.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/EpiVec/TDLM/releases/tag/v1.1.1">Version 1.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/EpiVec/TDLM/releases/tag/v1.1.0">Version 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/EpiVec/TDLM/releases/tag/v1.0.0">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/EpiVec/TDLM/releases/tag/v0.1.0">Version 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EpiVec/TDLM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate mobility flows based on different trip distribution laws</h1>
      <small class="dont-index">Source: <a href="https://github.com/EpiVec/TDLM/blob/master/R/run_law.R" class="external-link"><code>R/run_law.R</code></a></small>
      <div class="d-none name"><code>run_law.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates mobility flows using different distribution laws
and models. As described in Lenormand <em>et al.</em> (2016), the
function uses a two-step approach to generate mobility flows by separating
the trip distribution law (gravity or intervening opportunities) from the
modeling approach used to generate the flows based on this law. This function
only uses the first step to generate a probability distribution based on the
different laws.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_law</span><span class="op">(</span></span>
<span>  law <span class="op">=</span> <span class="st">"Unif"</span>,</span>
<span>  <span class="va">mass_origin</span>,</span>
<span>  mass_destination <span class="op">=</span> <span class="va">mass_origin</span>,</span>
<span>  distance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  opportunity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check_names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-law">law<a class="anchor" aria-label="anchor" href="#arg-law"></a></dt>
<dd><p>A <code>character</code> indicating which law to use (see Details).</p></dd>


<dt id="arg-mass-origin">mass_origin<a class="anchor" aria-label="anchor" href="#arg-mass-origin"></a></dt>
<dd><p>A <code>numeric</code> vector representing the mass at the origin (i.e.
demand).</p></dd>


<dt id="arg-mass-destination">mass_destination<a class="anchor" aria-label="anchor" href="#arg-mass-destination"></a></dt>
<dd><p>A <code>numeric</code> vector representing the mass at
the destination (i.e. attractiveness).</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>A squared <code>matrix</code> representing the distance between locations
(see Details).</p></dd>


<dt id="arg-opportunity">opportunity<a class="anchor" aria-label="anchor" href="#arg-opportunity"></a></dt>
<dd><p>A squared <code>matrix</code> representing the number of opportunities
between locations (see Details). Can be easily computed with
<code><a href="extract_opportunities.html">extract_opportunities()</a></code>.</p></dd>


<dt id="arg-param">param<a class="anchor" aria-label="anchor" href="#arg-param"></a></dt>
<dd><p>A <code>numeric</code> vector or a single <code>numeric</code> value used to adjust
the importance of <code>distance</code> or <code>opportunity</code> associated with the chosen law.
Not necessary for the original radiation law or the uniform law (see
Details).</p></dd>


<dt id="arg-check-names">check_names<a class="anchor" aria-label="anchor" href="#arg-check-names"></a></dt>
<dd><p>A <code>boolean</code> indicating whether the location IDs used as
matrix rownames and colnames should be checked for consistency
(see Note).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>TDLM</code>. An object of class <code>TDLM</code>. A <code>list</code> of <code>list</code> of
matrice containing for each parameter value the matrix of probabilities
(called <code>proba</code>). If <code>length(param) = 1</code> or <code>law = "Rad"</code> or <code>law = "Unif"</code>
only a list of matrices will be returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>We compute the matrix <code>proba</code> estimating the probability to observe a
trip from one location to another. This probability is based on the demand
(argument <code>mass_origin</code>) and the attractiveness (argument
<code>mass_destination</code>). Note that the population is typically used as a
surrogate for both quantities (this is why <code>mass_destination = mass_origin</code>
by default). It also depends on the distance between locations
(argument <code>distance</code>) OR the number of opportunities between locations
(argument <code>opportunity</code>) depending on the chosen law. Both the effect of the
distance and the number of opportunities can be adjusted with a parameter
(argument <code>param</code>) except for the original radiation law and the uniform law.</p>
<p>In this package we consider eight probabilistic laws described in details in
Lenormand <em>et al.</em> (2016). Four
gravity laws (Barthelemy, 2011), three
intervening opportunity laws (Schneider, 1959; Simini <em>et al.</em>, 2012;
Yang <em>et al.</em>, 2014) and a uniform law.</p><ol><li><p>Gravity law with an exponential distance decay function
(<code>law = "GravExp"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Normalized gravity law with an exponential distance decay function
(<code>law = "NGravExp"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Gravity law with a power distance decay function
(<code>law = "GravPow"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Normalized gravity law with a power distance decay function
(<code>law = "NGravPow"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Schneider's intervening opportunities law (<code>law = "Schneider"</code>). The
arguments <code>mass_origin</code>, <code>mass_destination</code> (optional), <code>opportunity</code> and
<code>param</code> will be used.</p></li>
<li><p>Radiation law (<code>law = "Rad"</code>). The arguments <code>mass_origin</code>,
<code>mass_destination</code> (optional) and <code>opportunity</code> will be used.</p></li>
<li><p>Extended radiation law (<code>law = "RadExt"</code>). The arguments <code>mass_origin</code>,
<code>mass_destination</code> (optional), <code>opportunity</code> and <code>param</code> will be used.</p></li>
<li><p>Uniform law (<code>law = "Unif"</code>). The argument <code>mass_origin</code> will be used to
extract the number of locations.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>All inputs should be based on the same number of
locations, sorted in the same order. It is recommended to use the location ID
as <code>matrix</code> <code>rownames</code> and <code>matrix</code> <code>colnames</code> and to set
<code>check_names = TRUE</code> to verify that everything is consistent before running
this function (<code>check_names = FALSE</code> by default). Note that the function
<code><a href="check_format_names.html">check_format_names()</a></code> can be used to validate all inputs
before running the main package's functions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Barthelemy M (2011). Spatial Networks. <em>Physics Reports</em> 499, 1-101.</p>
<p>Lenormand M, Bassolas A, Ramasco JJ (2016) Systematic comparison of trip
distribution laws and models. <em>Journal of Transport Geography</em> 51,
158-169.</p>
<p>Schneider M (1959) Gravity models and trip distribution theory. <em>Papers
of the regional science association</em> 5, 51-58.</p>
<p>Simini F, González MC, Maritan A &amp; Barabási A (2012) A universal model for
mobility and migration patterns. <em>Nature</em> 484, 96-100.</p>
<p>Yang Y, Herrera C, Eagle N &amp; González MC (2014) Limits of Predictability in
Commuting Flows in the Absence of Data for Calibration. <em>Scientific
Reports</em> 4, 5662.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>For more details illustrated with a practical example,
see the vignette:
<a href="https://epivec.github.io/TDLM/articles/TDLM.html#run-functions">https://epivec.github.io/TDLM/articles/TDLM.html#run-functions</a>.</p>
<p>Associated functions:
<code><a href="run_law_model.html">run_law_model()</a></code>, <code><a href="run_model.html">run_model()</a></code>, <code><a href="gof.html">gof()</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">distance</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mass</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mj</span> <span class="op">&lt;-</span> <span class="va">mi</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">run_law</span><span class="op">(</span></span></span>
<span class="r-in"><span>  law <span class="op">=</span> <span class="st">"GravExp"</span>, mass_origin <span class="op">=</span> <span class="va">mi</span>, mass_destination <span class="op">=</span> <span class="va">mj</span>,</span></span>
<span class="r-in"><span>  distance <span class="op">=</span> <span class="va">distance</span>, opportunity <span class="op">=</span> <span class="cn">NULL</span>, param <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>  check_names <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print(res)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maxime Lenormand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

