<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function estimates mobility flows using different distribution laws.
As described in (Lenormand et al. 2016)
, we
propose a two-step approach to generate mobility flows by separating the trip
distribution law, gravity or intervening opportunities, from the modeling
approach used to generate the flows from this law. This function only uses
the first step to generate a probability distribution based on the different
laws."><title>Estimate mobility flows based on different trip distribution laws — run_law • TDLM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate mobility flows based on different trip distribution laws — run_law"><meta property="og:description" content="This function estimates mobility flows using different distribution laws.
As described in (Lenormand et al. 2016)
, we
propose a two-step approach to generate mobility flows by separating the trip
distribution law, gravity or intervening opportunities, from the modeling
approach used to generate the flows from this law. This function only uses
the first step to generate a probability distribution based on the different
laws."><meta property="og:image" content="https://epivec.github.io/TDLM/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TDLM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/TDLM.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EpiVec/TDLM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate mobility flows based on different trip distribution laws</h1>
      <small class="dont-index">Source: <a href="https://github.com/EpiVec/TDLM/blob/HEAD/R/run_law.R" class="external-link"><code>R/run_law.R</code></a></small>
      <div class="d-none name"><code>run_law.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates mobility flows using different distribution laws.
As described in (Lenormand et al. 2016)
, we
propose a two-step approach to generate mobility flows by separating the trip
distribution law, gravity or intervening opportunities, from the modeling
approach used to generate the flows from this law. This function only uses
the first step to generate a probability distribution based on the different
laws.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_law</span><span class="op">(</span></span>
<span>  law <span class="op">=</span> <span class="st">"Unif"</span>,</span>
<span>  <span class="va">mass_origin</span>,</span>
<span>  mass_destination <span class="op">=</span> <span class="va">mass_origin</span>,</span>
<span>  distance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  opportunity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check_names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>law</dt>
<dd><p>a character indicating which law to use (see Details).</p></dd>


<dt>mass_origin</dt>
<dd><p>a numeric vector representing the mass at origin (i.e.
demand).</p></dd>


<dt>mass_destination</dt>
<dd><p>a numeric vector representing the mass at
destination (i.e. attractiveness).</p></dd>


<dt>distance</dt>
<dd><p>a squared matrix representing the distance between locations
(see Details).</p></dd>


<dt>opportunity</dt>
<dd><p>a squared matrix representing the number of opportunities
between locations (see Details). Can be easily computed with
<code><a href="extract_opportunities.html">extract_opportunities()</a></code>.</p></dd>


<dt>param</dt>
<dd><p>a vector of numeric value(s) used to adjust the importance of
<code>distance</code> or <code>opportunity</code> associated with the chosen law. A single value or
a vector of several parameter values can be used (see Return). Not necessary
for the original radiation law or the uniform law (see Details).</p></dd>


<dt>check_names</dt>
<dd><p>a boolean indicating if the ID location are used as
vector names, matrix rownames and colnames and if they should be checked
(see Note).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>TDLM</code>. A list of list of matrices containing for each
parameter value the matrix of probabilities (called <code>proba</code>). If
<code>length(param) == 1</code> or <code>law == "Rad"</code> or <code>law == "Unif</code> only a list of
matrices will be returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
<p>We compute the matrix <code>proba</code> estimating the probability
<em></em>\(p_{ij}\) to observe a trip from location <em></em>\(i\) to
another location <em></em>\(j\)
(<em></em>\(\sum_{i}\sum_{j} p_{ij}=1\)). This
probability is based on the demand <em></em>\(m_{i}\)
(argument <code>mass_origin</code>) and the attractiveness
<em></em>\(m_{j}\) (argument <code>mass_destination</code>). Note that the population
is typically used as a surrogate for both quantities (this is why
<code>mass_destination = mass_origin</code> by default). It also depends on the
distance <em></em>\(d_{ij}\) between locations (argument <code>distance</code>) OR
the number of opportunities <em></em>\(s_{ij}\) between locations
(argument <code>opportunity</code>) depending on the chosen law. Both the effect of the
distance and the number of opportunities can be adjusted with a parameter
(argument <code>param</code>) except for the original radiation law or the uniform law.</p>
<p>In this package we consider eight probabilistic laws
described in details in Lenormand et al. (2016)
. Four
gravity laws
(Carey 1858; Zipf 1946; Barthelemy 2011; Lenormand et al. 2016)
, three
intervening opportunity laws
(Schneider 1959; Simini et al. 2012; Yang et al. 2014)
 and a uniform law.</p><ol><li><p>Gravity law with an exponential distance decay function
(<code>law = "GravExp"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Normalized gravity law with an exponential distance decay function
(<code>law = "NGravExp"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Gravity law with a power distance decay function
(<code>law = "GravPow"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Normalized gravity law with a power distance decay function
(<code>law = "NGravPow"</code>). The arguments <code>mass_origin</code>, <code>mass_destination</code>
(optional), <code>distance</code> and <code>param</code> will be used.</p></li>
<li><p>Schneider's intervening opportunities law (<code>law = "Schneider"</code>). The
arguments <code>mass_origin</code>, <code>mass_destination</code> (optional), <code>opportunity</code> and
<code>param</code> will be used.</p></li>
<li><p>Radiation law (<code>law = "Rad"</code>). The arguments <code>mass_origin</code>,
<code>mass_destination</code> (optional) and <code>opportunity</code> will be used.</p></li>
<li><p>Extended radiation law (<code>law = "RadExt"</code>). The arguments <code>mass_origin</code>,
<code>mass_destination</code> (optional), <code>opportunity</code> and <code>param</code> will be used.</p></li>
<li><p>Uniform law (<code>law = "Unif"</code>). The argument <code>mass_origin</code> will be used to
extract the number of locations.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>All the inputs should be based on the same number of
locations sorted in the same order. It is recommended to use the location ID
as vector names, matrix rownames and matrix colnames and to set
<code>check_names = TRUE</code> to verify that everything is in order before running
this function (<code>check_names = FALSE</code> by default). Note that the function
<code><a href="check_format_names.html">check_format_names()</a></code> can be used to control the validity of all the inputs
before running the main package's functions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lenormand M, Bassolas A, Ramasco JJ (2016).
“Systematic comparison of trip distribution laws and models.”
<em>Journal of Transport Geography</em>, <b>51</b>, 158-169.</p>
<p>Carey HC (1858).
<em>Principles of Social Science</em>.
Lippincott.</p>
<p>Zipf GK (1946).
“The P1 P2/D Hypothesis: On the Intercity Movement of Persons.”
<em>American Sociological Review</em>, <b>11</b>(6), 677--686.</p>
<p>Barthelemy M (2011).
“Spatial Networks.”
<em>Physics Reports</em>, <b>499</b>, 1-101.</p>
<p>Schneider M (1959).
“Gravity models and trip distribution theory.”
<em>Papers of the regional science association</em>, <b>5</b>, 51-58.</p>
<p>Simini F, González MC, Maritan A, Barabasi A (2012).
“A universal model for mobility and migration patterns.”
<em>Nature</em>, <b>484</b>, 96-100.</p>
<p>Yang Y, Herrera C, Eagle N, González MC (2014).
“Limits of Predictability in Commuting Flows in the Absence of Data for Calibration.”
<em>Scientific Reports</em>, <b>4</b>(5662), 5662.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gof.html">gof()</a></code> <code><a href="run_law_model.html">run_law_model()</a></code> <code><a href="run_model.html">run_model()</a></code> <code><a href="extract_opportunities.html">extract_opportunities()</a></code>
<code><a href="check_format_names.html">check_format_names()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Maxime Lenormand (<a href="mailto:maxime.lenormand@inrae.fr">maxime.lenormand@inrae.fr</a>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mass</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">distance</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mass</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mj</span> <span class="op">&lt;-</span> <span class="va">mi</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">run_law</span><span class="op">(</span></span></span>
<span class="r-in"><span>  law <span class="op">=</span> <span class="st">"GravExp"</span>, mass_origin <span class="op">=</span> <span class="va">mi</span>, mass_destination <span class="op">=</span> <span class="va">mj</span>,</span></span>
<span class="r-in"><span>  distance <span class="op">=</span> <span class="va">distance</span>, opportunity <span class="op">=</span> <span class="cn">NULL</span>, param <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>  check_names <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># print(res)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maxime Lenormand.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

